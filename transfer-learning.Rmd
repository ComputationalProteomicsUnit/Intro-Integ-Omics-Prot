# A transfer learning algorithms for different data domains

Combining quantitative (spatial) proteomics and (binary) annotation
features.

### Standard spatial proteomics workflow

![Spatial proteomics workflow](./figure/workflow_primary.png)


|        | F1   | F2   | ...  | Fm   |  markers   |
|-------:|-----:|-----:|-----:|-----:|-----------:|
| prot 1 |q(1,1)|q(1,2)| ...  |q(1,m)| unknown    |
| prot 2 |q(2,1)|q(2,2)| ...  |q(2,m)| Mito       |
| prot 3 |q(3,1)|q(3,2)| ...  |q(3,m)| Golgi      |
| ...    | ...  | ...  | ...  | ...  | ...        |
| prot n |q(n,1)|q(n,2)| ...  |q(n,m)| unknown    |


### Another data source

What about annotation data from repositories such as GO, sequence
features, signal peptide, transmembrane domains, images,
protein-protein interactions, ...

From a user perspective:

- free/cheap vs. expensive

- Abundant (all proteins, 100s of features) vs. (experimentally)
  limited/targeted (1000s of proteins, 6 - 20 of features)

- **But**, for the localisation of proteins in the cells and
  conditions at hand: low vs. high quality (i.e. sub-cellular
  discriminative power and specificity). We need to be careful not to
  dilute the signal in the experimental data with the annotation data.

Updated **dual** worflow:

![Dual proteomics workflow](./figure/workflow.png)

### Data integration

We use a *class-weighted kNN transfer learning algorithm* to combine
primary (experimental) and auxiliary (annotation) data, based on
[Wu and Dietterich (2004)](http://citeseer.ist.psu.edu/viewdoc/summary?doi=10.1.1.94.594).

We compute *weights* for:

- the two data sources (experimental = primary and annotation =
  auxiliary)
- for different data classes (sub-cellular niches)

### [Method description](https://github.com/ComputationalProteomicsUnit/Intro-Integ-Omics-Prot/blob/master/thetatut.pdf?raw=true)

### Example code

#### Loading the software and data

```{r env, eval=FALSE}
library("pRoloc")
library("pRolocdata")
data(andy2011)
```

#### Preparing the auxiliary data
```{r aux, eval=FALSE}
ap <- setAnnotationParams(inputs =
                              c("Homo sapiens",
                                "UniProt/Swissprot ID"))

andygoset <- makeGoSet(andy2011)
```

#### Optimising weights
```{r thetaopt, eval=FALSE}
thopt <- thetaOptimisation(andy2011, andygoset)
plot(thopt)
```

#### Predicting sub-cellular localisation
```{r thetaclass, eval=FALSE}
th <- getParams(thopt)
thes <- thetaClassification(andy2011, andygoset, bestTheta = th)
```

### References

Gatto L, Breckels LM, Burger T, Nightingale DJ, Groen AJ, Campbell C,
Nikolovski N, Mulvey CM, Christoforou A, Ferro M, Lilley KS. A
foundation for reliable spatial proteomics data analysis. Mol Cell
Proteomics. 2014 Aug;13(8):1937-52. doi: 10.1074/mcp.M113.036350. Epub
2014 May 20. PubMed
PMID:[24846987](http://www.ncbi.nlm.nih.gov/pubmed/24846987); PubMed
Central PMCID:PMC4125728.


Gatto L, Breckels LM, Wieczorek S, Burger T, Lilley KS.
Mass-spectrometry-based spatial proteomics data analysis using pRoloc
and pRolocdata. Bioinformatics. 2014 May 1;30(9):1322-4. doi:
10.1093/bioinformatics/btu013. Epub 2014 Jan 11. PubMed
PMID:[24413670](http://www.ncbi.nlm.nih.gov/pubmed/24413670); PubMed
Central PMCID:PMC3998135.


Breckels LM, Holden S, Christoforou A, Lilley KS, Gatto L. A Transfer
Learning Framework for Spatial Proteomics Data. In prep.


| [Home](./README.md) | [Caveats](./Caveats.md) | [Mapping](./mapping.md) | [Transfer learning](./transfer-learning.md) |
